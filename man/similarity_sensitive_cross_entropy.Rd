% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/relative_diversity.R
\name{similarity_sensitive_cross_entropy}
\alias{similarity_sensitive_cross_entropy}
\title{Calculate Similarity-Sensitive Cross-Entropy Between Probability Distributions}
\usage{
similarity_sensitive_cross_entropy(
  p,
  q,
  similarity_matrix,
  base = exp(1),
  normalize_similarity = FALSE
)
}
\arguments{
\item{p}{A numeric vector representing the first probability distribution (should sum to 1)}

\item{q}{A numeric vector representing the second probability distribution (should sum to 1)}

\item{similarity_matrix}{A square matrix of similarities between categories.}

\item{base}{The logarithm base to use (default: natural logarithm, base e)}

\item{normalize_similarity}{Logical. Whether to normalize the similarity matrix
so that rows sum to 1. Default is FALSE.}
}
\value{
The similarity-sensitive cross-entropy value
}
\description{
This function computes the similarity-sensitive cross-entropy between two
probability distributions, which generalizes the standard cross-entropy by
incorporating similarities between categories.
}
\details{
The similarity-sensitive cross-entropy between distributions P and Q is defined as:
\deqn{H_S(P,Q) = -\sum_{i=1}^{n} \sum_{j=1}^{n} s_{ij} p_i \log(q_j)}
where p_i and q_j are the probabilities in distributions P and Q,
s_{ij} is the similarity between categories i and j, and n is the number of categories.
}
\examples{
# Create two probability distributions
p <- c(0.5, 0.3, 0.2)
q <- c(0.2, 0.3, 0.5)

# Create a similarity matrix
sim_matrix <- matrix(c(
  1.0, 0.3, 0.1,
  0.3, 1.0, 0.6,
  0.1, 0.6, 1.0
), nrow = 3, byrow = TRUE)

# Calculate cross-entropy
cross_ent <- similarity_sensitive_cross_entropy(p, q, sim_matrix)
print(cross_ent)

}
