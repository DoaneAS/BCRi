% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/relative_diversity.R
\name{similarity_sensitive_entropy}
\alias{similarity_sensitive_entropy}
\title{Calculate Similarity-Sensitive Shannon Entropy and Diversity}
\usage{
similarity_sensitive_entropy(
  probabilities,
  similarity_matrix,
  base = exp(1),
  normalize_similarity = FALSE,
  optimization_method = c("numerical", "analytical"),
  check_inputs = TRUE,
  computeMax = FALSE,
  return_optimal_probs = FALSE
)
}
\arguments{
\item{probabilities}{A numeric vector of probabilities that should sum to 1}

\item{similarity_matrix}{A square matrix of similarities between categories.
Diagonal elements are typically 1 (self-similarity).
Off-diagonal elements typically range from 0 (no similarity) to 1 (identical).}

\item{base}{The logarithm base to use (default: natural logarithm, base e)}

\item{normalize_similarity}{Logical. Whether to normalize the similarity matrix
so that rows sum to 1. Default is FALSE.}

\item{optimization_method}{Method to find maximum entropy:
"analytical" - For standard Shannon entropy or simple similarity matrices
"numerical" - Uses optimization for complex similarity matrices (default)}

\item{check_inputs}{Logical. Whether to validate inputs. Default is TRUE.}

\item{return_optimal_probs}{Logical. Whether to return the probability distribution
that achieves maximum entropy/diversity. Default is TRUE.}
}
\value{
A list containing:
- entropy: The similarity-sensitive Shannon entropy for the provided probabilities
- diversity: The corresponding diversity measure (exp(entropy))
- max_entropy: The maximum possible similarity-sensitive Shannon entropy
- max_diversity: The maximum possible diversity measure
- normalized_entropy: The ratio of entropy to max_entropy (ranges from 0 to 1)
- normalized_diversity: The ratio of diversity to max_diversity (ranges from 0 to 1)
- optimal_probs: (if return_optimal_probs=TRUE) The probability distribution
that achieves maximum entropy/diversity
}
\description{
This function computes a generalized version of Shannon entropy and the corresponding
diversity measure that accounts for similarities between categories. It also calculates
the theoretical maximum values of both measures.
}
\details{
The similarity-sensitive Shannon entropy is defined as:
\deqn{H_S(p) = -\sum_{i=1}^{n} \sum_{j=1}^{n} s_{ij} p_i \log(p_j)}
The corresponding diversity measure is:
\deqn{D_S(p) = e^{H_S(p)}}
where p_i are the probabilities, s_{ij} is the similarity between categories i and j,
and n is the number of categories.
}
\examples{
# Create a custom similarity matrix
custom_sim <- matrix(c(
  1.0, 0.3, 0.1,
  0.3, 1.0, 0.6,
  0.1, 0.6, 1.0
), nrow = 3, byrow = TRUE)

# Calculate entropy, diversity and their maximum values
probs <- c(0.5, 0.3, 0.2)
result <- similarity_sensitive_entropy(probs, custom_sim)
print(result)

}
