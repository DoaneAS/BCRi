% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weighted_rich_gini_simpson.R
\name{weighted_rich_gini_simpson_affinity}
\alias{weighted_rich_gini_simpson_affinity}
\title{Calculate the weighted Rich-Gini-Simpson diversity index with affinity weights}
\usage{
weighted_rich_gini_simpson_affinity(
  abundance_matrix,
  affinity_weights = NULL,
  normalize_phenos = TRUE,
  zero_handling = c("keep", "remove", "ignore"),
  return_pheno_values = FALSE
)
}
\arguments{
\item{abundance_matrix}{A matrix where rows represent seqs and columns
represent phenos. Values are seqs abundances or proportions.}

\item{affinity_weights}{A vector of affinity importance weights for each seqs.
If NULL, all seqs are weighted equally.}

\item{normalize_phenos}{Logical. Whether to normalize abundances at each pheno
to sum to 1. Default is TRUE.}

\item{zero_handling}{How to handle seqs with zero abundance:
"keep" (default) - include zeros in richness count
"remove" - remove seqs with zero abundance at each pheno
"ignore" - don't multiply by n (use regular weighted Gini-Simpson)}

\item{return_pheno_values}{Logical. If TRUE, returns individual pheno values
along with the overall index. Default is FALSE.}

\item{sequence_weights}{A symmetric matrix of weights between seqs.
If NULL, uses standard weights (1-Î´_ij).}

\item{pheno_weights}{Optional vector of weights for each pheno. If NULL, all
phenos are weighted equally.}
}
\value{
A list containing:
- index: The overall weighted Rich-Gini-Simpson index
- max_index: The theoretical maximum value of the index
- normalized_index: The index divided by its maximum value (0-1 scale)
- affinity_weighted_index: The index weighted by seqs affinity importance
- pheno_indices: (if return_pheno_values=TRUE) Individual pheno indices
- pheno_max_indices: (if return_pheno_values=TRUE) Maximum possible indices per pheno
- sequence_weighted_pheno_indices: (if return_pheno_values=TRUE) affinity-weighted indices per pheno
}
\description{
This function computes the weighted Rich-Gini-Simpson index for seqs
abundance data collected across multiple phenos, while incorporating seqs
affinity importance. It also calculates the theoretical maximum value
of the index for comparison.
}
\examples{
# Create a sample abundance matrix (5 seqs across 3 phenos)
abundance <- matrix(c(
  10, 5,  0,   # seqs 1 abundances across 3 phenos
  2,  15, 8,   # seqs 2
  0,  3,  12,  # seqs 3
  20, 10, 5,   # seqs 4
  5,  0,  2    # seqs 5
), nrow = 5, byrow = TRUE)

# Create affinity weights (higher values = more affinity importance)
affinity_weights <- c(2.0, 1.0, 3.0, 0.5, 1.5)

# Get index with affinity weighting
result <- weighted_rich_gini_simpson_affinity(
  abundance,
  affinity_weights = affinity_weights
)
print(result)

}
